@mrjloswald

/*

1. Save the Code:
a) Copy the entire code above and paste it into a text file.
b) Save the file by naming it "MotionBlurConverter.swift".

2. Set Input and Output Paths:
a) Change the line let imagePath = "/path/to/your/image.jpg" to point to the actual path of your input image file.
b) Change the line let outputPath = "/path/to/your/output_image.png" to specify where you want to save the processed image.

3. Compile the Code:
a) Open your terminal and navigate to the directory where you saved the MotionBlurConverter.swift file.
b Compile the Swift file using the following command: swiftc MotionBlurConverter.swift -o MotionBlurConverter

4. Run the Program:
Run the compiled program with: ./MotionBlurConverter

5. Follow Prompts:
When prompted in the terminal, enter the blur radius (between 0 and 100) and the angle of motion blur in degrees.

*/

import Foundation
import CoreImage
import UIKit

func applyMotionBlur(to image: UIImage, radius: CGFloat, angle: CGFloat) -> UIImage? {
    guard let ciImage = CIImage(image: image) else { return nil }
    
    let motionBlurFilter = CIFilter(name: "CIMotionBlur")!
    motionBlurFilter.setValue(ciImage, forKey: kCIInputImageKey)
    motionBlurFilter.setValue(radius, forKey: kCIInputRadiusKey)
    motionBlurFilter.setValue(angle * .pi / 180, forKey: kCIInputAngleKey) // Convert degrees to radians
    
    guard let outputImage = motionBlurFilter.outputImage else { return nil }
    return UIImage(ciImage: outputImage)
}

// Main execution starts here

let imagePath = "/path/to/your/image.jpg" // Change this line to your image path
guard let inputImage = UIImage(contentsOfFile: imagePath) else {
    print("Failed to load image")
    exit(1)
}

print("Enter blur radius (0-100): ", terminator: "")
guard let radiusInput = readLine(), let radius = CGFloat(Double(radiusInput) ?? 0), radius >= 0 && radius <= 100 else {
    print("Invalid input. Please enter a number between 0 and 100.")
    exit(1)
}

print("Enter blur angle (in degrees): ", terminator: "")
guard let angleInput = readLine(), let angle = CGFloat(Double(angleInput) ?? 0) else {
    print("Invalid input. Please enter a valid angle.")
    exit(1)
}

if let outputImage = applyMotionBlur(to: inputImage, radius: radius, angle: angle) {
    print("Motion blur applied successfully.")
    
    // Save the output image (you can specify the output path)
    let outputPath = "/path/to/your/output_image.png" // Change this line to your desired output path
    
    guard let data = outputImage.pngData() else {
        print("Failed to convert image to PNG data.")
        exit(1)
    }
    
    do {
        try data.write(to: URL(fileURLWithPath: outputPath))
        print("Output image saved to \(outputPath)")
    } catch {
        print("Failed to save image: \(error)")
    }
} else {
    print("Failed to apply motion blur.")
}
